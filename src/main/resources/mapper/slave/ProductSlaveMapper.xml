<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.bfly.management.mapper.slave.ProductSlaveMapper">

    <!-- 상품군 조회 -->
    <select id="getProduct" resultType="String" parameterType="Integer">
        SELECT JSON_AGG(pm.fn_get_json_product_group(A.prd_grp_id) ORDER BY A.sort) AS result 
        FROM pm.product_group A 
        WHERE A.status = 1 
        AND A.upp_prd_grp_id = 0 /*최상위 ROOT prd_grp_id*/
        AND A.sid = #{sId} /*서비스ID*/
    </select>

    <!-- 옵션 카테고리 조회 -->
    <select id="getOptionCategory" resultType="String" parameterType="Integer">
        SELECT 
            pm.fn_get_json_option_category(#{p_opt_cat_id}) AS result
    </select>


    <!-- 상품 상세리스트 조회-->
    <select id="getProductDetail" resultType="String" parameterType="Integer">    
        SELECT 
            pm.fn_get_json_product_detail(#{p_prd_id}) AS result
    </select>

</mapper>